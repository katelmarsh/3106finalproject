---
title: "project_3"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## API Calls 

https://aqs.epa.gov/aqsweb/documents/data_api.html#daily

```{r air quality}
library(httr)
library(dplyr)
library(jsonlite)

out <- httr::GET("https://aqs.epa.gov/data/api/dailyData/byState?email=klm2244@columbia.edu&key=ecruwren53&param=88101,88502&bdate=20190101&edate=20191231&state=37"
          #,query = list(
  #key= "bolewren15",
  #)
  )
# only permit one year of data ugh 
content(out)[[2]][[1]]$latitude
content(out)[[2]][[1]]$longitude 
content(out)[[2]][[1]]$aqi # seems like we want to use this metric 
head(out$request$headers)

response <- content(out)
head(response)
response[[2]][[1]]$aqi

l <- sapply(response$aqi,length)
l_p <- sapply(job_desc$request_params,length)
description <- response

aqi_l = c()
for (i in 1:length(description)){
  for (j in 1:length(description[[i]])){
    if (is.na(description[[i]][j])){
      next
    }
    aqi_l <- append(aqi_l,description[[i]][j])
  }
}



unlisted <- lapply(response, unlist)

put_together <- lapply(unlisted, function(x) as.data.frame(as.list(table(x))))
df <- plyr::rbind.fill(put_together)
df[is.na(df)] <- 0


```
Links to Water Quality data 
https://coast.noaa.gov/digitalcoast/data/water-quality.html
https://www.waterqualitydata.us/
https://www.waterqualitydata.us/portal/#countrycode=US&statecode=US%3A37&startDateLo=01-01-2019&startDateHi=12-31-2019&mimeType=csv

```{r water quality}

#stations.csv 
water_tx <- read.csv("narrowresult.csv")
water_tx$ResultMeasureValue
water_tx$OrganizationIdentifier
water_tx2 <- read.csv("station.csv")
water_tx2$VerticalMeasure.MeasureValue
water_tx2$DrainageAreaMeasure.MeasureValue
water_tx2$ContributingDrainageAreaMeasure.MeasureValue
water_tx2$HorizontalAccuracyMeasure.MeasureValue


```

```{r water quality testing}
# using water quality data that we have from texas 

water_tx[1,]
# temp is ResultMeasureValue
# apparently I only pulled the temperature data 




```
